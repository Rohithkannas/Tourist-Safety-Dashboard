<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Analytics & Reports â€¢ Tourist Safety</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script> tailwind.config = { theme: { extend: { colors: { bgdark: '#000000' } } } } </script>
  <link rel="stylesheet" href="./assets/css/styles.css" />
  <style>
    body { background:#000; }
    .header-line { height:1px; background:rgba(255,255,255,0.18); }
  </style>
</head>
<body class="text-white">
  <div class="header-line"></div>
  <header class="topbar">
    <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
      <div class="text-sm tracking-wide text-white/80" data-i18n="app_title">Tourist Safety Dashboard</div>
      <nav class="text-sm flex items-center gap-2">
        <a href="./dashboard.html" class="btn" data-i18n="nav_dashboard">Dashboard</a>
        <a href="./alerts.html" class="btn" data-i18n="nav_alerts">Alerts</a>
        <a href="./geofence.html" class="btn" data-i18n="nav_geofence">Geofence</a>
        <a href="./audit.html" class="btn" data-i18n="nav_audit">Audit</a>
        <a href="./settings.html" class="btn" data-i18n="nav_settings">Settings</a>
      </nav>
    </div>
  </header>
  <div class="header-line"></div>

  <main class="max-w-7xl mx-auto px-4 py-8 space-y-6">
    <section class="grid md:grid-cols-2 gap-6">
      <div class="p-4 border border-white/10 rounded-lg bg-white/5">
        <h2 class="font-semibold mb-3" data-i18n="analytics_density">Tourist Density Heatmap (Demo)</h2>
        <canvas id="heatmap" height="220"></canvas>
      </div>
      <div class="p-4 border border-white/10 rounded-lg bg-white/5">
        <h2 class="font-semibold mb-3" data-i18n="analytics_incidents">Incidents Over Time (Demo)</h2>
        <canvas id="chartIncidents" height="200"></canvas>
      </div>
    </section>

    <section class="grid md:grid-cols-2 gap-6">
      <div class="p-4 border border-white/10 rounded-lg bg-white/5">
        <h2 class="font-semibold mb-3" data-i18n="analytics_safety">Safety Score Pattern (Demo)</h2>
        <canvas id="chartSafety" height="200"></canvas>
      </div>
      <div class="p-4 border border-white/10 rounded-lg bg-white/5">
        <h2 class="font-semibold mb-3" data-i18n="analytics_reports">Exportable Reports</h2>
        <button id="exportBtn" class="btn" data-i18n="export_pdf">Export PDF (Demo)</button>
      </div>
    </section>

    <!-- Extra visuals: Risk distribution and visitors sparkline -->
    <section class="grid md:grid-cols-2 gap-6">
      <div class="p-4 border border-white/10 rounded-lg bg-white/5">
        <h2 class="font-semibold mb-3">Risk Distribution (Demo)</h2>
        <canvas id="chartScatter" height="200"></canvas>
      </div>
      <div class="p-4 border border-white/10 rounded-lg bg-white/5">
        <h2 class="font-semibold mb-3">Daily Visitors (Demo)</h2>
        <canvas id="chartVisitors" height="200"></canvas>
      </div>
    </section>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
  <script src="./assets/js/i18n.js"></script>
  <script>
    (function(){ const t = localStorage.getItem('theme')||'dark'; if (t==='light') document.body.classList.add('light'); })();
    I18N.apply();
    // Heatmap (mock) - draw colored grid directly on canvas
    (function(){
      const canvas = document.getElementById('heatmap');
      const ctx = canvas.getContext('2d');
      const W = canvas.width = canvas.clientWidth; const H = canvas.height;
      const cols = 16, rows = 10;
      const cw = Math.floor(W/cols), ch = Math.floor(H/rows);
      function color(v){ // v: 0..1
        const r = Math.floor(239*v + 34*(1-v)); // #ef4444 -> #22c55e path reversed for cool effect
        const g = Math.floor(68*v + 197*(1-v));
        const b = Math.floor(68*v + 94*(1-v));
        return `rgba(${r},${g},${b},0.85)`;
      }
      for (let y=0;y<rows;y++){
        for (let x=0;x<cols;x++){
          const v = Math.random();
          ctx.fillStyle = color(v);
          ctx.fillRect(x*cw+1, y*ch+1, cw-2, ch-2);
        }
      }
    })();
    const ctxI = document.getElementById('chartIncidents');
    new Chart(ctxI, { type:'line', data:{ labels:['Mon','Tue','Wed','Thu','Fri','Sat','Sun'], datasets:[
      { label:'Incidents', data:[3,6,4,8,5,7,2], borderColor:'#60a5fa', backgroundColor:'rgba(96,165,250,0.2)', tension:0.35, fill:true },
      { label:'Resolved', data:[2,5,3,6,4,6,2], borderColor:'#34d399', backgroundColor:'rgba(52,211,153,0.15)', tension:0.35, fill:true }
    ]}, options:{ plugins:{legend:{labels:{color:'#fff'}}}, scales:{ x:{ticks:{color:'#fff'}}, y:{ticks:{color:'#fff'}} } });
    const ctxS = document.getElementById('chartSafety');
    new Chart(ctxS, { type:'line', data:{ labels:['Patrols','Response','Infra','Awareness','Weather'], datasets:[
      { label:'Score', data:[80,65,70,60,55], borderColor:'#fbbf24', backgroundColor:'rgba(251,191,36,0.2)', fill:true, tension:0.35 },
      { label:'Target', data:[85,70,75,65,60], borderColor:'#93c5fd', backgroundColor:'rgba(147,197,253,0.15)', fill:true, tension:0.35 }
    ]}, options:{ plugins:{legend:{labels:{color:'#fff'}}}, scales:{ x:{ticks:{color:'#fff'}}, y:{ticks:{color:'#fff'}} } });
    // Scatter for risk distribution
    const ctxScatter = document.getElementById('chartScatter');
    new Chart(ctxScatter, { type:'scatter', data:{ datasets:[{ label:'Risk Points', data: Array.from({length:60},()=>({x:Math.random()*100,y:Math.random()*100})), backgroundColor:'rgba(239,68,68,0.6)' }] }, options:{ plugins:{legend:{labels:{color:'#fff'}}}, scales:{ x:{ticks:{color:'#fff'}}, y:{ticks:{color:'#fff'}} } });
    // Bar chart visitors
    const ctxVisitors = document.getElementById('chartVisitors');
    new Chart(ctxVisitors, { type:'bar', data:{ labels:Array.from({length:30},(_,i)=>i+1), datasets:[{ label:'Visitors', data: Array.from({length:30},()=> Math.floor(Math.random()*50)+50), backgroundColor:'rgba(255,255,255,0.4)'}] }, options:{ plugins:{legend:{labels:{color:'#fff'}}}, scales:{ x:{ticks:{color:'#fff'}}, y:{ticks:{color:'#fff'}} } });
    document.getElementById('exportBtn').addEventListener('click', ()=> alert('Demo: Export generated!'));
  </script>
</body>
</html>
